Start with sampleXspecies table (e.g. sample_by_species_table_F2308_minimap2_20200916_kelpie20200917.csv)

_FSL corrections_ from Ji et al. (2020) SPIKEPIPE paper
1. Lysis buffer correction. – For each sample (row), calculate lysis_ratio, which is the proportion of the total lysis buffer that was used for DNA extraction (aliquot / lysisBufferml). For example, if half the lysis buffer of a sample was used, lysis_ratio is 0.5. Finally, divide the read number of each species in the row by lysis_ratio

2. Spike-in correction. – (a) For each sample (row), calculate the spike_wt_mean. Divide COISpikeElaterid by 9 and then take the mean of COISpikeElaterid and COISpikeMordellid. Finally, divide the read number of each species in the row by spike_wt_mean.

_Quasi-probability correction_
3. For each species (column), scale to a quasiprobability: scales::rescale(log(x + 0.001))


